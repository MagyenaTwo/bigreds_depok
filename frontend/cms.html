{% extends "base.html" %}

{% block title %}Galeri Nobar - CMS Bigreds Depok{% endblock %}

{% block content %}
<h1>Galeri Nobar</h1>

<!-- Upload Form -->
<form action="/cms/upload" method="post" enctype="multipart/form-data" class="upload-form" style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin-bottom: 30px;">
  <h2 style="margin-bottom: 15px;">Upload Media Baru</h2>
  
  <label for="title">Judul</label><br>
  <input type="text" id="title" name="title" required style="width: 100%; margin-bottom: 10px;"><br>
<label for="tanggal">Tanggal & Waktu</label><br>
<input type="datetime-local" id="tanggal" name="tanggal" required style="margin-bottom: 10px;"><br>

 
<label for="kategori">Kategori</label><br>
<select id="kategori" name="kategori" required style="width: 100%; margin-bottom: 10px; padding: 5px;">
  <option value="">-- Pilih Kategori --</option>
  <option value="matchday">Matchday</option>
  <option value="community">Community</option>
  <option value="event">Event</option>
</select><br>


  <label for="image">Pilih Gambar/Video</label><br>
  <input type="file" id="image" name="image" multiple accept="image/*,video/*" required style="margin-bottom: 10px;"><br>

  <button type="submit">Upload</button>
</form>

<!-- Search and Counter -->
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px;">
  <input type="text" id="searchInput" placeholder="Cari berdasarkan judul..." class="search-input" onkeyup="filterTable()" style="flex: 1; max-width: 250px;">
  <div style="font-weight: bold; font-size: 15px; display: flex; flex-direction: column; align-items: flex-end;">
    <div><span style="font-size: 18px;">üñºÔ∏è</span> Total Media: {{ images|length }}</div>
  </div>
</div>

<!-- Media List Table -->
<div class="table-container">
  <table class="styled-table" id="mediaTable">
  <thead>
  <tr>
    <th>No</th>
    <th>Judul</th>
    <th>Kategori</th>
    <th>Tanggal</th>
    <th>Lihat</th>
  </tr>
</thead>
<tbody>
  {% for media in images %}
  <tr>
    <td>{{ loop.index }}</td>
    <td>{{ media.title }}</td>
    <td>{{ media.kategori or '-' }}</td> <!-- tampilkan kategori -->
    <td>
      {% if media.tanggal %}
        {{ media.tanggal|datetimeformat('%d-%m-%Y') }}
      {% else %}
        -
      {% endif %}
    </td>
    <td><a href="{{ media.image_url }}" target="_blank" class="bukti-btn">Lihat</a></td>
  </tr>
  {% endfor %}
</tbody>
</table>

  <div class="pagination" style="margin-top: 25px;">
  {% if current_page > 1 %}
    <a href="?page={{ current_page - 1 }}">&laquo; Prev</a>
  {% endif %}

  {% for i in range(1, total_pages + 1) %}
    <a href="?page={{ i }}" class="{% if i == current_page %}active{% endif %}">{{ i }}</a>
  {% endfor %}

  {% if current_page < total_pages %}
    <a href="?page={{ current_page + 1 }}">Next &raquo;</a>
  {% endif %}
</div>


</div>

<script>
  function filterTable() {
    const input = document.getElementById("searchInput").value.toLowerCase();
    const rows = document.querySelectorAll("#mediaTable tbody tr");
    rows.forEach(row => {
      const judul = row.cells[1].textContent.toLowerCase();
      row.style.display = judul.includes(input) ? "" : "none";
    });
  }
</script>
{% endblock %}
